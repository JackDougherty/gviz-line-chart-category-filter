<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Google Visualization ScatterChart Series by JackDougherty</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script type="text/javascript" src="//www.google.com/jsapi"></script>
    <script type="text/javascript">
google.load('visualization', '1', {packages: ['controls']});
google.setOnLoadCallback(drawChart);

function drawChart () {
    var data = new google.visualization.DataTable();
    data.addColumn('string', 'Grade');
    data.addColumn('number', 'Asian Studies');
    data.addColumn('number', 'Batchelder');
    data.addColumn('number', 'Burns');
    data.addColumn('number', 'Hooker');
    data.addColumn('number', 'Hooker (Hartford Residents)');
    data.addColumn('number', 'MD Fox');
    data.addColumn('number', 'Kennelly');
    data.addColumn('number', 'Kinsella');
    data.addColumn('number', 'Kinsella (Hartford Residents)');
    data.addColumn('number', 'ML King');
    data.addColumn('number', 'Burr');
    data.addColumn('number', 'Clark');
    data.addColumn('number', 'Breakthrough');
    data.addColumn('number', 'Breakthrough (Hartford Residents)');
    data.addColumn('number', 'SAND');
    data.addColumn('number', 'McDonough');
    data.addColumn('number', 'Moylan');
    data.addColumn('number', 'Naylor');
    data.addColumn('number', 'Parkville');
    data.addColumn('number', 'Rawson');
    data.addColumn('number', 'Milner');
    data.addColumn('number', 'Webster');
    data.addColumn('number', 'Webster (Hartford Residents)');
    data.addColumn('number', 'West Middle');
    data.addColumn('number', 'Wish');
    data.addColumn('number', 'STEM at AF');
    data.addColumn('number', 'STEM at AF (Hartford Residents)');
    data.addColumn('number', 'Betances');
    data.addColumn('number', 'Simpson-Waverly');
    data.addColumn('number', 'Sanchez');
    data.addColumn('number', 'Achievement First');
    data.addColumn('number', 'HMMS');
    data.addColumn('number', 'HMMS (Hartford Residents)');
    data.addColumn('number', 'Classical');
    data.addColumn('number', 'Classical (Hartford Residents)');
    data.addColumn('number', 'Capital');
    data.addColumn('number', 'Capital (Hartford Residents)');
    data.addColumn('number', 'Sports & Med'); 
    data.addColumn('number', 'Sports & Med (Hartford Residents)');
    data.addColumn('number', 'Hartford');
    data.addRows([
        ['Grade 3 (2007)',  59.8, 62.6, 35.6, 57, 0, 38.2, 52.7, 38.3, 38.6, 33.8, 56.7, 53.4, 73.3, 61.5, 45.4, 43.3, 41.7, 50, 55.6, 66.7, 30.8, 66.2, 63.1, 46.4, 51.7, 35.8, 0, 50, 42.9, 33.5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 46.3],
        ['Grade 4 (2008)',  70.6, 48.3, 28.5, 54.6, 0, 42.3, 47.9, 46.3, 45.3, 45.9, 56.3, 17.4, 72.9, 68.3, 38.2, 57.3, 40.1, 56.9, 69.9, 58.3, 29.7, 66.7, 64.4, 50.7, 58.6, 42, 0, 40.1, 53.4, 38.2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 47.8],
        ['Grade 5 (2009)',  47.3, 59.7, 41.1, 70.3, 0, 52.7, 67.2, 67, 62, 53.2, 56.7, 29.7, 72.1, 63.8, 28.7, 46.2, 50, 65.7, 76.3, 54.8, 21.4, 68.6, 63.3, 57.6, 73.5, 56.5, 0, 36.9, 64, 40.7, 61.3, 0, 0, 0, 0, 0, 0, 0, 0, 54.1],
        ['Grade 6 (2010)',  60.9, 60.3, 50.3, 70.2, 0, 53.8, 66.4, 77.8, 68.5, 77.4, 73.2, 42.4, 86, 80.9, 58.1, 58.9, 63.5, 57.4, 78, 67.5, 44, 87.9, 83.7, 57.4, 80, 70.3, 0, 0, 89.5, 51.6, 81.7, 85.3, 76.9, 80.9, 74.8, 66.2, 61.5, 0, 0, 69.2],
        ['Grade 7 (2011)',  41.9, 66.2, 39.7, 56.7, 56.7, 0, 47, 90.4, 86.7, 49, 61.8, 50.5, 75.8, 69, 48.4, 39.4, 54.4, 45.7, 0, 64, 24.4, 87, 81.3, 62.3, 62.2, 84.1, 80, 0, 76.9, 0, 85.5, 83, 76.3, 76.8, 67.5, 73.2, 69.1, 78.3, 68, 64],
        ['Grade 8 (2012)',  40.2, 58.6, 39.1, 64.1, 69, 0, 48.4, 79, 69.2, 58.5, 47.8, 34.8, 80.6, 75, 56.5, 34.2, 0, 47.8, 0, 46.6, 38.3, 90.9, 87.5, 69.4, 59.6, 84.7, 80.3, 0, 64.3, 0, 89.7, 80.2, 72.5, 73.2, 61.4, 74.3, 69.4, 80.7, 68.8, 61.3],
    ]);

    var columnsTable = new google.visualization.DataTable();
    columnsTable.addColumn('number', 'colIndex');
    columnsTable.addColumn('string', 'colLabel');
    var initState= {selectedValues: []};
    // put the columns into this data table (skip column 0)
    for (var i = 1; i < data.getNumberOfColumns(); i++) {
        columnsTable.addRow([i, data.getColumnLabel(i)]);
        // you can comment out this next line if you want to have a default selection other than the whole list
        initState.selectedValues.push(data.getColumnLabel(i));
    }
    // you can set individual columns to be the default columns (instead of populating via the loop above) like this:
    // initState.selectedValues.push(data.getColumnLabel(4));
    
    var chart = new google.visualization.ChartWrapper({
        chartType: 'LineChart',
        containerId: 'chart_div',
        dataTable: data,
        options: {
            title: '2007 Cohort: Percentage at Proficient',
            width: 600,
            height: 400
        }
    });
    
    var columnFilter = new google.visualization.ControlWrapper({
        controlType: 'CategoryFilter',
        containerId: 'colFilter_div',
        dataTable: columnsTable,
        options: {
            filterColumnLabel: 'colLabel',
            ui: {
                label: 'Columns',
                allowTyping: false,
                allowMultiple: true,
                allowNone: false,
                selectedValuesLayout: 'below'
            }
        },
        'state': {'selectedValues': ['Hartford']}
    });
    
    function setChartView () {
        var state = columnFilter.getState();
        var row;
        var view = {
            columns: [0]
        };
        for (var i = 0; i < state.selectedValues.length; i++) {
            row = columnsTable.getFilteredRows([{column: 1, value: state.selectedValues[i]}])[0];
            view.columns.push(columnsTable.getValue(row, 0));
        }
        // sort the indices into their original order
        view.columns.sort(function (a, b) {
            return (a - b);
        });
        chart.setView(view);
        chart.draw();
    }
    google.visualization.events.addListener(columnFilter, 'statechange', setChartView);
    
    setChartView();
    columnFilter.draw();
}

 </script>
  </head>
  <body>
      <!-- This div will hold the chart. Modify your own text and links -->
      <h3>Insert title here</h3>
    <div id="colFilter_div"></div>
  <div id="chart_div"></div>
  <p>Data source: Achieve Hartford. Visualization by Marissa Block (Trinity College '14), <a href="http://commons.trincoll.edu/data" target="_blank">DataViz seminar</a>. See<a href="https://github.com/JackDougherty/gviz-line-chart-category-filter" target="_blank"> code on GitHub</a>.</p>
  <div id="creativeCommons" style="text-align: center; width: 400px;">
    <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/InteractiveResource" property="dct:title" rel="dct:type">Code to use a CategoryFilter as a column selector</span> by <span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Andrew Gallant</span> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>.
  </div>
  </body>
</html>
